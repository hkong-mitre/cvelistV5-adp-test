{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-30391",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "state": "PUBLISHED",
        "assignerShortName": "juniper",
        "dateReserved": "2024-03-26T23:06:17.994Z",
        "datePublished": "2024-04-12T15:25:24.733Z",
        "dateUpdated": "2024-07-05T14:56:52.551Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "SRX Series",
                        "MX Series with SPC3"
                    ],
                    "product": "Junos OS",
                    "vendor": "Juniper Networks",
                    "versions": [
                        {
                            "lessThan": "20.4R3-S7",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.1R3",
                            "status": "affected",
                            "version": "21.1",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.2R2-S1, 21.2R3",
                            "status": "affected",
                            "version": "21.2",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.3R1-S2, 21.3R2",
                            "status": "affected",
                            "version": "21.3",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "For a device to be affected IPsec must be configured with either&nbsp;hmac-sha-384 or hmac-sha-512 as follows:<br><br>&nbsp; [ security&nbsp;ipsec&nbsp;proposal &lt;proposal&gt; authentication-algorithm hmac-sha-384/hmac-sha-512 ]"
                        }
                    ],
                    "value": "For a device to be affected IPsec must be configured with either hmac-sha-384 or hmac-sha-512 as follows:\n\n  [ security ipsec proposal <proposal> authentication-algorithm hmac-sha-384/hmac-sha-512 ]"
                }
            ],
            "datePublic": "2024-04-10T16:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "A Missing Authentication for Critical Function vulnerability in the Packet Forwarding Engine (pfe) of Juniper Networks Junos OS on MX Series with SPC3, and&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">SRX Series&nbsp;</span>allows an unauthenticated network-based attacker to cause limited impact to the integrity or availability of the device.<br><br>If a device is configured with IPsec authentication algorithm hmac-sha-384 or hmac-sha-512, tunnels are established normally but for traffic traversing the tunnel no authentication information is sent with the encrypted data on egress, and no authentication information is expected on ingress. So if the peer is an unaffected device transit traffic is going to fail in both directions. If the peer is an also affected device transit traffic works, but without authentication, and configuration and CLI operational commands indicate authentication is performed.<br><p>This issue affects Junos OS:</p><p></p><ul><li><span style=\"background-color: var(--wht);\">All versions before 20.4R3-S7,</span></li><li><span style=\"background-color: var(--wht);\">21.1 versions before 21.1R3,&nbsp;</span></li><li><span style=\"background-color: var(--wht);\">21.2 versions before 21.2R2-S1, 21.2R3,&nbsp;</span></li><li><span style=\"background-color: var(--wht);\">21.3 versions before 21.3R1-S2, 21.3R2.</span></li></ul><p></p>"
                        }
                    ],
                    "value": "A Missing Authentication for Critical Function vulnerability in the Packet Forwarding Engine (pfe) of Juniper Networks Junos OS on MX Series with SPC3, and SRX Series allows an unauthenticated network-based attacker to cause limited impact to the integrity or availability of the device.\n\nIf a device is configured with IPsec authentication algorithm hmac-sha-384 or hmac-sha-512, tunnels are established normally but for traffic traversing the tunnel no authentication information is sent with the encrypted data on egress, and no authentication information is expected on ingress. So if the peer is an unaffected device transit traffic is going to fail in both directions. If the peer is an also affected device transit traffic works, but without authentication, and configuration and CLI operational commands indicate authentication is performed.\nThis issue affects Junos OS:\n\n\n\n  *  All versions before 20.4R3-S7,\n  *  21.1 versions before 21.1R3, \n  *  21.2 versions before 21.2R2-S1, 21.2R3, \n  *  21.3 versions before 21.3R1-S2, 21.3R2."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                        }
                    ],
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "LOW",
                        "baseScore": 4.8,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "LOW",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                },
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "PRESENT",
                        "attackVector": "NETWORK",
                        "baseScore": 6.3,
                        "baseSeverity": "MEDIUM",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "NONE",
                        "subConfidentialityImpact": "NONE",
                        "subIntegrityImpact": "NONE",
                        "userInteraction": "NONE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "LOW",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "LOW",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-306",
                            "description": "CWE-306 Missing Authentication for Critical Function",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2024-05-16T20:24:44.347Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "http://supportportal.juniper.net/JSA79188"
                },
                {
                    "tags": [
                        "technical-description"
                    ],
                    "url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "The following software releases have been updated to resolve this specific issue: 20.4R3-S7, 21.1R3, 21.2R2-S1, 21.2R3, \n\n21.3R1-S2, 21.3R2, 21.4R1, and all subsequent releases.<br>\n\n<br><span style=\"background-color: rgb(255, 255, 255);\">Please note that for releases earlier than 21.1 the affected CLI options have been removed. For releases from 21.1 onwards the issue has been fixed.<br></span>\n\n<br>"
                        }
                    ],
                    "value": "The following software releases have been updated to resolve this specific issue: 20.4R3-S7, 21.1R3, 21.2R2-S1, 21.2R3, \n\n21.3R1-S2, 21.3R2, 21.4R1, and all subsequent releases.\n\n\n\nPlease note that for releases earlier than 21.1 the affected CLI options have been removed. For releases from 21.1 onwards the issue has been fixed."
                }
            ],
            "source": {
                "advisory": "JSA79188",
                "defect": [
                    "1557177"
                ],
                "discovery": "INTERNAL"
            },
            "title": "Junos OS: MX Series with SPC3, and SRX Series: When IPsec authentication is configured with \"hmac-sha-384\" and \"hmac-sha-512\" no authentication of traffic is performed",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>There are no known workarounds for this issue.</p>"
                        }
                    ],
                    "value": "There are no known workarounds for this issue."
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        },
        "adp": [
            {
                "providerMetadata": {
                    "orgId": "96f1cf3c-f80a-4e0f-a063-99a91e3f1325",
                    "shortName": "secretariat-reference",
                    "dateUpdated": "2024-07-05T14:56:52.551Z"
                },
                "references": [
                    {
                        "tags": [
                            "vendor-advisory",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "http://supportportal.juniper.net/JSA79188/DEMO_2024_06_19"
                    },
                    {
                        "tags": [
                            "technical-description",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N/DEMO_2024_06_19"
                    },
                    {
                        "tags": [
                            "vendor-advisory",
                            "x_snapshot"
                        ],
                        "url": "http://supportportal.juniper.net/JSA79188/adp-test-6-28"
                    },
                    {
                        "tags": [
                            "technical-description",
                            "x_snapshot"
                        ],
                        "url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N/adp-test-6-28"
                    }
                ]
            }
        ]
    }
}