{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-3744",
        "assignerOrgId": "a6081bf6-c852-4425-ad4f-a67919267565",
        "state": "PUBLISHED",
        "assignerShortName": "kubernetes",
        "dateReserved": "2024-04-12T19:54:26.953Z",
        "datePublished": "2024-05-15T00:42:36.881Z",
        "dateUpdated": "2024-07-05T18:12:27.381Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "azure-file-csi-driver",
                    "vendor": "Kubernetes",
                    "versions": [
                        {
                            "lessThanOrEqual": "<=",
                            "status": "affected",
                            "version": "v1.29.3",
                            "versionType": "semver"
                        },
                        {
                            "status": "affected",
                            "version": "v1.30.0"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "value": "Weizhi Chen @cvvz"
                }
            ],
            "datePublic": "2024-05-08T17:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<div>A security issue was discovered in azure-file-csi-driver where an actor with access to the driver logs could observe service account tokens. These tokens could then potentially be exchanged with external cloud providers to access secrets stored in cloud vault solutions. Tokens are only logged when TokenRequests is configured in the CSIDriver object and the driver is set to run at log level 2 or greater via the -v flag.</div>"
                        }
                    ],
                    "value": "A security issue was discovered in azure-file-csi-driver where an actor with access to the driver logs could observe service account tokens. These tokens could then potentially be exchanged with external cloud providers to access secrets stored in cloud vault solutions. Tokens are only logged when TokenRequests is configured in the CSIDriver object and the driver is set to run at log level 2 or greater via the -v flag.\n\n"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-54",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-54 Query System for Information"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "NONE",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-532",
                            "description": "CWE-532 Insertion of Sensitive Information into Log File",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a6081bf6-c852-4425-ad4f-a67919267565",
                "shortName": "kubernetes",
                "dateUpdated": "2024-05-15T00:42:36.881Z"
            },
            "references": [
                {
                    "tags": [
                        "mailing-list"
                    ],
                    "url": "https://groups.google.com/g/kubernetes-security-announce/c/hcgZE2MQo1A/m/Y4C6q-CYAgAJ"
                },
                {
                    "tags": [
                        "issue-tracking"
                    ],
                    "url": "https://github.com/kubernetes/kubernetes/issues/124759"
                },
                {
                    "url": "http://www.openwall.com/lists/oss-security/2024/05/09/4"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<div><div>Prior to upgrading, this vulnerability can be mitigated by running azure-file-csi-driver at log level 0 or 1 via the -v flag.To upgrade, refer to the documentation: <a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/kubernetes-sigs/azurefile-csi-driver?tab=readme-ov-file#install-driver-on-a-kubernetes-cluster\">https://github.com/kubernetes-sigs/azurefile-csi-driver?tab=readme-ov-file#install-driver-on-a-kubernetes-cluster</a><</div></div>"
                        }
                    ],
                    "value": "Prior to upgrading, this vulnerability can be mitigated by running azure-file-csi-driver at log level 0 or 1 via the -v flag. To upgrade, refer to the documentation: https://github.com/kubernetes-sigs/azurefile-csi-driver?tab=readme-ov-file#install-driver-on-a-kubernetes-cluster \n\n\n\n"
                }
            ],
            "source": {
                "discovery": "EXTERNAL"
            },
            "title": "Kubernetes azure-file-csi-driver in versions before 1.29.4 and 1.30.1 discloses service account tokens in logs",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        },
        "adp": [
            {
                "providerMetadata": {
                    "orgId": "96f1cf3c-f80a-4e0f-a063-99a91e3f1325",
                    "shortName": "secretariat-reference",
                    "dateUpdated": "2024-07-05T18:12:27.381Z"
                },
                "references": [
                    {
                        "tags": [
                            "mailing-list",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://groups.google.com/g/kubernetes-security-announce/c/hcgZE2MQo1A/m/Y4C6q-CYAgAJ/DEMO_2024_06_19"
                    },
                    {
                        "tags": [
                            "issue-tracking",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://github.com/kubernetes/kubernetes/issues/124759/DEMO_2024_06_19"
                    },
                    {
                        "url": "http://www.openwall.com/lists/oss-security/2024/05/09/4/DEMO_2024_06_19",
                        "tags": [
                            "x_cve_prog_secretariat_snapshot"
                        ]
                    },
                    {
                        "tags": [
                            "mailing-list",
                            "x_snapshot"
                        ],
                        "url": "https://groups.google.com/g/kubernetes-security-announce/c/hcgZE2MQo1A/m/Y4C6q-CYAgAJ/adp-test-6-28"
                    },
                    {
                        "tags": [
                            "issue-tracking",
                            "x_snapshot"
                        ],
                        "url": "https://github.com/kubernetes/kubernetes/issues/124759/adp-test-6-28"
                    },
                    {
                        "url": "http://www.openwall.com/lists/oss-security/2024/05/09/4/adp-test-6-28",
                        "tags": [
                            "x_snapshot"
                        ]
                    }
                ]
            }
        ]
    }
}