{
    "containers": {
        "cna": {
            "affected": [
                {
                    "product": "SAP Manufacturing Integration and Intelligence",
                    "vendor": "SAP SE",
                    "versions": [
                        {
                            "status": "affected",
                            "version": "< 15.1"
                        },
                        {
                            "status": "affected",
                            "version": "< 15.2"
                        },
                        {
                            "status": "affected",
                            "version": "< 15.3"
                        },
                        {
                            "status": "affected",
                            "version": "< 15.4"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "value": "SAP MII allows users to create dashboards and save them as JSP through the SSCE (Self Service Composition Environment). An attacker can intercept a request to the server, inject malicious JSP code in the request and forward to server. When this dashboard is opened by users having at least SAP_XMII Developer role, malicious content in the dashboard gets executed, leading to remote code execution in the server, which allows privilege escalation. The malicious JSP code can contain certain OS commands, through which an attacker can read sensitive files in the server, modify files or even delete contents in the server thus compromising the confidentiality, integrity and availability of the server hosting the SAP MII application. Also, an attacker authenticated as a developer can use the application to upload and execute a file which will permit them to execute operating systems commands completely compromising the server hosting the application."
                }
            ],
            "metrics": [
                {
                    "cvssV3_0": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 9.9,
                        "baseSeverity": "CRITICAL",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
                        "version": "3.0"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "description": "Code Execution",
                            "lang": "en",
                            "type": "text"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "dateUpdated": "2022-05-10T20:07:26",
                "orgId": "e4686d1a-f260-4930-ac4c-2f5c992778dd",
                "shortName": "sap"
            },
            "references": [
                {
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107"
                },
                {
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://launchpad.support.sap.com/#/notes/3022622"
                },
                {
                    "name": "20210614 Onapsis Security Advisory 2021-0012: SAP Manufacturing Integration and Intelligence lack of server side validations leads to RCE",
                    "tags": [
                        "mailing-list",
                        "x_refsource_FULLDISC"
                    ],
                    "url": "http://seclists.org/fulldisclosure/2021/Jun/30"
                },
                {
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html"
                },
                {
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html"
                }
            ],
            "x_legacyV4Record": {
                "CVE_data_meta": {
                    "ASSIGNER": "cna@sap.com",
                    "ID": "CVE-2021-21480",
                    "STATE": "PUBLIC"
                },
                "affects": {
                    "vendor": {
                        "vendor_data": [
                            {
                                "product": {
                                    "product_data": [
                                        {
                                            "product_name": "SAP Manufacturing Integration and Intelligence",
                                            "version": {
                                                "version_data": [
                                                    {
                                                        "version_name": "<",
                                                        "version_value": "15.1"
                                                    },
                                                    {
                                                        "version_name": "<",
                                                        "version_value": "15.2"
                                                    },
                                                    {
                                                        "version_name": "<",
                                                        "version_value": "15.3"
                                                    },
                                                    {
                                                        "version_name": "<",
                                                        "version_value": "15.4"
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                "vendor_name": "SAP SE"
                            }
                        ]
                    }
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "eng",
                            "value": "SAP MII allows users to create dashboards and save them as JSP through the SSCE (Self Service Composition Environment). An attacker can intercept a request to the server, inject malicious JSP code in the request and forward to server. When this dashboard is opened by users having at least SAP_XMII Developer role, malicious content in the dashboard gets executed, leading to remote code execution in the server, which allows privilege escalation. The malicious JSP code can contain certain OS commands, through which an attacker can read sensitive files in the server, modify files or even delete contents in the server thus compromising the confidentiality, integrity and availability of the server hosting the SAP MII application. Also, an attacker authenticated as a developer can use the application to upload and execute a file which will permit them to execute operating systems commands completely compromising the server hosting the application."
                        }
                    ]
                },
                "impact": {
                    "cvss": {
                        "baseScore": "9.9",
                        "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
                        "version": "3.0"
                    }
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "eng",
                                    "value": "Code Execution"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107",
                            "refsource": "MISC",
                            "url": "https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107"
                        },
                        {
                            "name": "https://launchpad.support.sap.com/#/notes/3022622",
                            "refsource": "MISC",
                            "url": "https://launchpad.support.sap.com/#/notes/3022622"
                        },
                        {
                            "name": "20210614 Onapsis Security Advisory 2021-0012: SAP Manufacturing Integration and Intelligence lack of server side validations leads to RCE",
                            "refsource": "FULLDISC",
                            "url": "http://seclists.org/fulldisclosure/2021/Jun/30"
                        },
                        {
                            "name": "http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html",
                            "refsource": "MISC",
                            "url": "http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html"
                        },
                        {
                            "name": "https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html",
                            "refsource": "MISC",
                            "url": "https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html"
                        }
                    ]
                }
            }
        },
        "adp": [
            {
                "title": "CISA ADP Pilot",
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2022-04-11T00:00:00+00:00",
                                "options": [
                                    {
                                        "Exploitation": "PoC"
                                    },
                                    {
                                        "Automatable": "slow"
                                    },
                                    {
                                        "Technical Impact": "Total"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3",
                                "id": "CVE-2021-21480"
                            }
                        }
                    }
                ],
                "providerMetadata": {
                    "orgId": "8c464350-323a-4346-a867-fc54517fa145",
                    "shortName": "CISAADP",
                    "dateUpdated": "2023-12-19T05:00:18.113Z"
                }
            },
            {
                "providerMetadata": {
                    "orgId": "96f1cf3c-f80a-4e0f-a063-99a91e3f1325",
                    "shortName": "secretariat-reference",
                    "dateUpdated": "2024-07-03T07:23:13.919Z"
                },
                "references": [
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107/DEMO_2024_06_19"
                    },
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://launchpad.support.sap.com/#/notes/3022622/DEMO_2024_06_19"
                    },
                    {
                        "name": "20210614 Onapsis Security Advisory 2021-0012: SAP Manufacturing Integration and Intelligence lack of server side validations leads to RCE",
                        "tags": [
                            "mailing-list",
                            "x_refsource_FULLDISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "http://seclists.org/fulldisclosure/2021/Jun/30/DEMO_2024_06_19"
                    },
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html/DEMO_2024_06_19"
                    },
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html/DEMO_2024_06_19"
                    },
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107/adp-test-6-28"
                    },
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "https://launchpad.support.sap.com/#/notes/3022622/adp-test-6-28"
                    },
                    {
                        "name": "20210614 Onapsis Security Advisory 2021-0012: SAP Manufacturing Integration and Intelligence lack of server side validations leads to RCE",
                        "tags": [
                            "mailing-list",
                            "x_refsource_FULLDISC",
                            "x_snapshot"
                        ],
                        "url": "http://seclists.org/fulldisclosure/2021/Jun/30/adp-test-6-28"
                    },
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html/adp-test-6-28"
                    },
                    {
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html/adp-test-6-28"
                    }
                ]
            }
        ]
    },
    "cveMetadata": {
        "assignerOrgId": "e4686d1a-f260-4930-ac4c-2f5c992778dd",
        "assignerShortName": "sap",
        "cveId": "CVE-2021-21480",
        "datePublished": "2021-03-09T14:10:47",
        "dateReserved": "2020-12-30T00:00:00",
        "dateUpdated": "2024-07-03T07:23:13.919Z",
        "state": "PUBLISHED"
    },
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1"
}