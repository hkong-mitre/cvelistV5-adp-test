{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2022-23552",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2022-01-19T21:23:53.801Z",
        "datePublished": "2023-01-27T22:59:16.675Z",
        "dateUpdated": "2024-07-04T03:19:00.109Z"
    },
    "containers": {
        "cna": {
            "title": "Grafana stored XSS in FileUploader component ",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-79",
                            "lang": "en",
                            "description": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 7.3,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N",
                        "version": "3.1"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv"
                },
                {
                    "name": "https://github.com/grafana/grafana/pull/62143",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/grafana/grafana/pull/62143"
                },
                {
                    "name": "https://github.com/grafana/grafana/commit/1c8a50b36973bd59a1cc5f34c30de8a9a6a431f0",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/grafana/grafana/commit/1c8a50b36973bd59a1cc5f34c30de8a9a6a431f0"
                },
                {
                    "name": "https://github.com/grafana/grafana/commit/8b574e22b53aa4c5a35032a58844fd4aaaa12f5f",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/grafana/grafana/commit/8b574e22b53aa4c5a35032a58844fd4aaaa12f5f"
                },
                {
                    "name": "https://github.com/grafana/grafana/commit/c022534e3848a5d45c0b3face23b43aa44e4400a",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/grafana/grafana/commit/c022534e3848a5d45c0b3face23b43aa44e4400a"
                }
            ],
            "affected": [
                {
                    "vendor": "grafana",
                    "product": "grafana",
                    "versions": [
                        {
                            "version": ">= 9.0, < 9.2.10",
                            "status": "affected"
                        },
                        {
                            "version": ">= 9.3, < 9.3.4",
                            "status": "affected"
                        },
                        {
                            "version": ">= 8.1, < 8.5.16",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2023-01-27T22:59:16.675Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "Grafana is an open-source platform for monitoring and observability. Starting with the 8.1 branch and prior to versions 8.5.16, 9.2.10, and 9.3.4, Grafana had a stored XSS vulnerability affecting the core plugin GeoMap. The stored XSS vulnerability was possible because SVG files weren't properly sanitized and allowed arbitrary JavaScript to be executed in the context of the currently authorized user of the Grafana instance. \n\nAn attacker needs to have the Editor role in order to change a panel to include either an external URL to a SVG-file containing JavaScript, or use the `data:` scheme to load an inline SVG-file containing JavaScript. This means that vertical privilege escalation is possible, where a user with Editor role can change to a known password for a user having Admin role if the user with Admin role executes malicious JavaScript viewing a dashboard.   \n\nUsers may upgrade to version 8.5.16, 9.2.10, or 9.3.4 to receive a fix."
                }
            ],
            "source": {
                "advisory": "GHSA-8xmm-x63g-f6xv",
                "discovery": "UNKNOWN"
            }
        },
        "adp": [
            {
                "providerMetadata": {
                    "orgId": "96f1cf3c-f80a-4e0f-a063-99a91e3f1325",
                    "shortName": "secretariat-reference",
                    "dateUpdated": "2024-07-04T03:19:00.109Z"
                },
                "references": [
                    {
                        "name": "Test (7655/24750) [3905/5000] <2/4>",
                        "tags": [
                            "x_test_run_data",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://example.org/CVE-2022-23552"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv",
                        "tags": [
                            "x_refsource_CONFIRM",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv/DEMO_2024_06_19"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/pull/62143",
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/pull/62143/DEMO_2024_06_19"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/commit/1c8a50b36973bd59a1cc5f34c30de8a9a6a431f0",
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/commit/1c8a50b36973bd59a1cc5f34c30de8a9a6a431f0/DEMO_2024_06_19"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/commit/8b574e22b53aa4c5a35032a58844fd4aaaa12f5f",
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/commit/8b574e22b53aa4c5a35032a58844fd4aaaa12f5f/DEMO_2024_06_19"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/commit/c022534e3848a5d45c0b3face23b43aa44e4400a",
                        "tags": [
                            "x_refsource_MISC",
                            "x_cve_prog_secretariat_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/commit/c022534e3848a5d45c0b3face23b43aa44e4400a/DEMO_2024_06_19"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv",
                        "tags": [
                            "x_refsource_CONFIRM",
                            "x_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv/adp-test-6-28"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/pull/62143",
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/pull/62143/adp-test-6-28"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/commit/1c8a50b36973bd59a1cc5f34c30de8a9a6a431f0",
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/commit/1c8a50b36973bd59a1cc5f34c30de8a9a6a431f0/adp-test-6-28"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/commit/8b574e22b53aa4c5a35032a58844fd4aaaa12f5f",
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/commit/8b574e22b53aa4c5a35032a58844fd4aaaa12f5f/adp-test-6-28"
                    },
                    {
                        "name": "https://github.com/grafana/grafana/commit/c022534e3848a5d45c0b3face23b43aa44e4400a",
                        "tags": [
                            "x_refsource_MISC",
                            "x_snapshot"
                        ],
                        "url": "https://github.com/grafana/grafana/commit/c022534e3848a5d45c0b3face23b43aa44e4400a/adp-test-6-28"
                    }
                ]
            }
        ]
    }
}